--// Fake Key System GUI (Draggable + Copy Invite + Fake Key Check + Run remote script)
-- LocalScript

-- Services
local Players = game:GetService("Players")
local StarterGui = game:GetService("StarterGui")

local player = Players.LocalPlayer

-- GUI Setup
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Parent = player:WaitForChild("PlayerGui")

local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0, 300, 0, 150)
MainFrame.Position = UDim2.new(0.5, -150, 0.5, -75)
MainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
MainFrame.BorderSizePixel = 0
MainFrame.Active = true
MainFrame.Draggable = true
MainFrame.Parent = ScreenGui

-- Title
local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1, 0, 0, 40)
Title.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
Title.Text = "ðŸ”‘ Key System"
Title.Font = Enum.Font.GothamBold
Title.TextSize = 18
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.Parent = MainFrame

-- Fake Key Input
local KeyBox = Instance.new("TextBox")
KeyBox.Size = UDim2.new(0.8, 0, 0, 30)
KeyBox.Position = UDim2.new(0.1, 0, 0.4, 0)
KeyBox.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
KeyBox.Text = ""
KeyBox.PlaceholderText = "Enter key here..."
KeyBox.Font = Enum.Font.Gotham
KeyBox.TextSize = 14
KeyBox.TextColor3 = Color3.fromRGB(255, 255, 255)
KeyBox.Parent = MainFrame

-- Copy Invite Button
local CopyBtn = Instance.new("TextButton")
CopyBtn.Size = UDim2.new(0.8, 0, 0, 30)
CopyBtn.Position = UDim2.new(0.1, 0, 0.7, 0)
CopyBtn.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
CopyBtn.Text = "ðŸ“‹ Copy Discord Invite"
CopyBtn.Font = Enum.Font.GothamBold
CopyBtn.TextSize = 14
CopyBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
CopyBtn.Parent = MainFrame

-- Corner Rounding
local function roundify(obj, radius)
	local UICorner = Instance.new("UICorner")
	UICorner.CornerRadius = UDim.new(0, radius)
	UICorner.Parent = obj
end

roundify(MainFrame, 10)
roundify(Title, 10)
roundify(KeyBox, 8)
roundify(CopyBtn, 8)

-- Discord Invite
local invite = "https://discord.gg/HtADeH8kQm" -- change this

CopyBtn.MouseButton1Click:Connect(function()
	if setclipboard then
		pcall(setclipboard, invite)
	end
	StarterGui:SetCore("SendNotification", {
		Title = "Copied!",
		Text = "Discord invite copied to clipboard.",
		Duration = 3
	})
end)

-- Fake Key System
local fakeKey = "rua-Fg9J5" -- change this to whatever key you want

-- Helper: notification
local function notify(title, text, dur)
	StarterGui:SetCore("SendNotification", {
		Title = title or "Notice",
		Text = text or "",
		Duration = dur or 4
	})
end

-- Helper: fetch remote URL using common executor functions
local function fetchUrl(url)
	-- Try game:HttpGet
	local ok, res = pcall(function()
		if game and game.HttpGet then
			return game:HttpGet(url)
		end
	end)
	if ok and type(res) == "string" and #res > 0 then
		return res
	end

	-- Try syn.request (Synapse)
	if syn and syn.request then
		local suc, resp = pcall(syn.request, { Url = url, Method = "GET" })
		if suc and resp and resp.Body and #resp.Body > 0 then
			return resp.Body
		end
	end

	-- Try http.request / http_request
	if http and http.request then
		local suc, resp = pcall(function()
			return http.request({ Url = url, Method = "GET" })
		end)
		if suc and resp and (resp.Body or resp.body) and #((resp.Body or resp.body)) > 0 then
			return (resp.Body or resp.body)
		end
	end

	-- Try global request/http_request (older)
	local req = request or http_request
	if req then
		local suc, resp = pcall(req, { Url = url, Method = "GET" })
		if suc and resp and (resp.Body or resp.body) and #((resp.Body or resp.body)) > 0 then
			return (resp.Body or resp.body)
		end
	end

	return nil, "no http function available or fetch failed"
end

KeyBox.FocusLost:Connect(function(enterPressed)
	if not enterPressed then return end

	if KeyBox.Text == fakeKey then
		notify("Success", "Key Accepted! Loading...", 3)

		-- REMOTE SCRIPT URL (the file you asked for)
		local url = "https://raw.githubusercontent.com/q6292/lua.new/refs/heads/main/TuanAnh%20Source%20(1).txt"

		-- Fetch
		local source, ferr = fetchUrl(url)
		if not source then
			notify("Fetch Failed", tostring(ferr or "unknown error"), 5)
			return
		end

		-- Basic sanity check
		if type(source) ~= "string" or #source < 10 then
			notify("Fetch Failed", "Remote script empty or invalid.", 5)
			return
		end

		-- Execute safely
		local ok, err = pcall(function()
			local fn = loadstring and loadstring(source) or load(source)
			if type(fn) ~= "function" then
				error("Failed to compile remote script.")
			end
			fn()
		end)

		if not ok then
			notify("Execution Error", tostring(err), 6)
			return
		end

		-- If execution succeeded, remove GUI
		MainFrame:Destroy()
	else
		StarterGui:SetCore("SendNotification", {
			Title = "Invalid",
			Text = "Wrong key!",
			Duration = 3
		})
	end
end)
